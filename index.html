<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Arabidopsis Interactions Viewer 2.0">
        <meta name="viewport" content="width=device-width, shrink-to-fit=no, initial-scale=1">
        <title>Arabidopsis Interactions Viewer (AIV) 2.0 </title>

        <!-- Latest compiled and minified Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

        <!-- Latest compiled and minified Bootstrap Javascript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
                integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

        <!-- Side bar -->
        <!-- Acknowledgement: https://blackrockdigital.github.io/startbootstrap-simple-sidebar/ -->
        <link rel="stylesheet" href="styles/simple-sidebar.css">

        <!-- Stylesheet for AIV 2.0 -->
        <link rel="stylesheet" href="styles/aiv.css">

        <!-- Cytoscape -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.2.7/cytoscape.min.js"></script>

        <!-- Cytoscape Canvas -->
        <script src="https://cdn.rawgit.com/classcraft/cytoscape.js-canvas/21c1084d/src/cytoscape-canvas.js"></script>

        <!-- Layout -->
        <script src="https://cdn.rawgit.com/maxkfranz/weaver/v1.2.0/dist/weaver.min.js"></script>
        <script src="https://cdn.rawgit.com/cytoscape/cytoscape.js-spread/9ce8be33/cytoscape-spread.js"></script>

        <!-- qtip2 -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" integrity="sha256-a+PRq3NbyK3G08Boio9X6+yFiHpTSIrbE7uzZvqmDac=" crossorigin="anonymous"></script>
        <script src="https://cdn.rawgit.com/cytoscape/cytoscape.js-qtip/02ebf16c/cytoscape-qtip.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.css"/>

        <!-- Cerebral Web Cytoscape Layout -->
        <script src="scripts/cerebralJSModified.js"></script>
        <script src="scripts/modifiedCerebralJSLayout.js"></script>

        <script src="https://cdn.rawgit.com/cytoscape/cytoscape.js-cose-bilkent/d810281d/cytoscape-cose-bilkent.js"></script>

        <!-- Highlight Js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css" integrity="sha256-akwTLZec/XAFvgYgVH1T5/369lhA2Efr22xzCNl1nHs=" crossorigin="anonymous"/>

        <!-- Font Awesome -->
        <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

        <!-- Google Font -->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">

        <!-- TableFilterJS -->
        <script src="https://unpkg.com/tablefilter@latest/dist/tablefilter/tablefilter.js"></script>

        <!--TableCSVExportjs-->
        <script src="https://cdn.rawgit.com/zachwick/TableCSVExport/398707ef/jquery.TableCSVExport.js"></script>

        <!-- To simplify coding TODO: Remove this during launch -->
        <script src="https://cdn.rawgit.com/Q42/LiveJS/bf827065/livejs.js"></script>
        <script src="./scripts/automateInput.js"></script>

    </head>

    <body>
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a href="//bar.utoronto.ca">
                        <img src="//bar.utoronto.ca/BAR/images/BAR.png" id="logo" class="img-responsive center-block">
                    </a>
                </div>

                <div class="flex-container-main">
                    <div class="flex-container-title">
                        <div class="flex-container-title-aiv">
                            <h3>Arabidopsis</h3>
                            <h3>Interactions </h3>
                            <h3>Viewer &nbsp &nbsp 2.0</h3>
                        </div>
                        <h4 id="showFormModal">Query</h4>
                        <h4 id="showLegendModal">Legend</h4>
                    </div>

                    <div class="flex-container-layout-buttons">
                        <p> Layouts </p>
                        <button class="button-layout" id="spreadLayout"></button>

                        <button class="button-layout" id="localizationLayout"></button>

                        <button class="button-layout" id="coseCompoundLayout"></button>
                    </div>

                    <div class="flex-container-zoom-pan-buttons">
                        <div class="flex-container-zoom-buttons">
                            <button class="button-zoom" id="zoomIn">
                                <i class="fas fa-search-plus fa-2x"></i>
                            </button>

                            <button class="button-zoom" id="zoomOut">
                                <i class="fas fa-search-minus fa-2x"></i>
                            </button>
                        </div>

                        <div class="flex-container-pan-buttons">
                            <button class="button-pan" id="panUp">
                                <i class="fas fa-caret-up fa-2x"></i>
                            </button>

                            <button class="button-pan" id="panLeft">
                                <i class="fas fa-caret-left fa-2x"></i>
                            </button>

                            <button class="button-pan" id="zoomReset">
                                <i class="fas fa-arrows-alt fa-lg"></i>
                            </button>

                            <button class="button-pan" id="panRight">
                                <i class="fas fa-caret-right fa-2x"></i>
                            </button>

                            <button class="button-pan" id="panDown">
                                <i class="fas fa-caret-down fa-2x"></i>
                            </button>
                        </div>

                    </div>

                    <div class="filter-column">
                        <section class="slider-checkbox">
                            <input id="filterNonQueryCheckbox" type="checkbox" class="filter-switch submit-reset">
                            <label class="label-checkbox" for="filterNonQueryCheckbox">
                                Hide Non-Query Genes
                            </label>
                        </section>
                        <section class="slider-checkbox">
                            <input id="hideMapMan" type="checkbox" class="submit-reset">
                            <label class="label-checkbox" for="hideMapMan">
                                Hide MapMan Numbers
                            </label>
                        </section>
                        <section class="slider-checkbox">
                            <input id="hideDonut" type="checkbox" class="submit-reset">
                            <label class="label-checkbox" for="hideDonut">
                                Hide Localization Data
                            </label>
                        </section>
                    </div>

                    <div class="filter-column">
                        <section class="slider-checkbox">
                            <input id="filterEPPIsCheckbox" type="checkbox" class="filter-switch submit-reset">
                            <label class="label-checkbox" for="filterEPPIsCheckbox">
                                Show Experimental PPIs with:
                            </label>
                        </section>
                        <label for="EPPICorrThreshold" class="threshold-label">
                            Correlation Coefficient greater than
                        </label>
                        <input id="EPPICorrThreshold" class="threshold" type="number" min="-1.0" max="1.0" step="0.1" value ="-1.0" maxlength="2" disabled/>
                        <div id="multi-select">
                            <div id="pseudo-select-box">
                                <select id="pseudo-select" class="not-allowed">
                                    <option>By specific publication(s)</option>
                                </select>
                                <div id="overSelect" class="not-allowed"></div>
                            </div>
                            <div id="ref-checkboxes">
                                <!-- The checkboxes will be added dynamically here -->
                            </div>
                        </div>
                    </div>

                    <div class="flex-container-PPPI-filter filter-column">
                        <section class="slider-checkbox">
                            <input id="filterPPPIsCheckbox" type="checkbox" class="filter-switch submit-reset">
                            <label class="label-checkbox" for="filterPPPIsCheckbox">
                                Show Predicted PPIs with:
                            </label>
                        </section>
                        <div>
                            <label for="PPPICorrThreshold">
                                Correlation Coefficient greater than
                            </label>
                            <input id="PPPICorrThreshold" class="threshold" type="number" min="-1.0" max="1.0" step="0.1" value ="-1.0" maxlength="2" disabled/>
                        </div>
                        <div>
                            <label for="PPPIConfThreshold">
                                Interolog Confidence greater than &nbsp
                            </label>
                            <input id="PPPIConfThreshold" class="threshold" type="number" min="0" max="90.0" step="1.0" value ="3.0" maxlength="2" disabled/>
                        </div>
                    </div>

                    <div class="flex-container-dropdowns">
                        <p>Data Source</p>
                        <select id="dropdownSource" disabled>
                            <option>Select Source</option>
                        </select>
                        <p>Tissue/Condition</p>
                        <select id="dropdownTissues" class="not-allowed" disabled>
                            <option>Select Tissue</option>
                        </select>
                    </div>

                    <div class="flex-container-dropdowns">
                        <section id="exprnOverlayChkAndLabel" class="slider-checkbox not-allowed" title="Select a source & tissue first!">
                            <input id="exprnOverlayChkbox" type="checkbox" class="submit-reset" disabled>
                            <label class="label-checkbox" for="exprnOverlayChkbox">
                                Overlay Expression
                            </label>
                        </section>
                        <form>
                            <input name="expression_mode" value="absolute" id="absExpression" type="radio" checked> <!-- Absolute as default -->
                            <label for="absExpression">
                                Abs
                            </label>
                            <input name="expression_mode" value="relative" id="relExpression" type="radio">
                            <label for="relExpression">
                                Rel
                            </label>
                        </form>
                        <section class="slider-checkbox">
                            <input id="exprThresholdChkbox" type="checkbox" class="filter-switch not-allowed submit-reset">
                            <label class="label-checkbox" for="exprThresholdChkbox">
                                Expr Limit
                            </label>
                        </section>
                        <input id="exprThreshold" type="number" min="1">
                    </div>

                    <div class="flex-container-export">
                        <button type="button" class="export-button" id="showCSVModal">Export CSV</button>
                        <button type="button" class="export-button" id="showPNGModal">Export PNG</button>
                        <button type="button" class="export-button" id="showJSONModal">Export JSON</button>
                    </div>
                </div>
            </div>
        </nav>
        <main>

            <!-- Page content -->
            <div>
                <div id="cy">
                    <canvas id="exprGradientCanvas" width="55" height="300"></canvas>
                </div>
                <div id="loading">
                </div>
            </div> <!-- Page content -->

        </main> <!-- wrapper -->

        <!-- Modals -->

        <!-- Form -->
        <div id="formModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>Welcome to Arabidopsis Interactions Viewer 2.0</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                        <br>
                        <h6>Visualize predicted and experimentally validated protein-protein/DNA interactions</h6>
                        <br>
                        <label class="collapse" for="aboutUs">Click to learn more</label>
                        <input id="aboutUs" type="checkbox">
                        <p>The Arabidopsis Interactions Viewer queries a database of 70944 predicted and 36352 confirmed Arabidopsis interacting
                            proteins. We have also included 2.8 million experimentally determined protein-DNA interactions. The predicted interactions (interologs) were generated by Drs Matt Geisler and Jane Geisler-Lee at the Southern Illinois University. Their current version is Interactome 2.0. The confirmed Arabidopsis interacting proteins come from
                            BIND, the Biomolecular Interaction Network Database, from high-density Arabidopsis protein microarrays (Popescu et al.,
                            2007; Popescu et al., 2009), from Braun et al.'s Arabidopsis Interactome 2011 , from Wolf Frommer's Membrane protein
                            INteractome Database MIND, and over 1190 other literature sources. The interactions in BIND were identified using several
                            different methods, such as yeast two hybrid screens, but also via traditional biochemical methods. Use the links to
                            BIND/MIND/AI/PubMed records that are in the output of this viewer to view further information. The DNA-protein data were generously provided by O'Mailey et al. (2016), Gaudinier et al. (2011), Taylor-Teeples (2015), Li et al. (2014), and Brady et al. (2011). All subcellular localisation data is from SUBA, the Arabidopsis Subcellular Database. Additional protein function data is from MapMan. Built with CytoscapeJS, much thanks to Max Franz and Asher Pasha for development advice. Developed by Vincent Lau
                            <a href="https://github.com/VinLau/AIV-v2-cytoscapeJS" target="_blank">Github Repo</a></p>
                    </div>
                    <div class="modal-body">
                        <form id="input_form">
                            <div class="form-group">
                                <label for="genes">Please enter a list of genes:</label>
                                <textarea class="form-control gene-form" id="genes" rows="15" placeholder="At2g34970"></textarea>
                                <br>
                                <p>Select options:</p>

                                <div class="checkbox">
                                    <label><input id="published" type="checkbox" class="form-chkbox" value="">Show only interactions from published data sets</label>
                                </div>

                                <div class="checkbox">
                                    <label><input id="predSUBA" type="checkbox" class="form-chkbox" value="" checked>Include predicted data for localization scores</label>
                                </div>

                                <p>Select databases to query:</p>

                                <div class="checkbox">
                                    <label class="not-allowed"><input id="queryBioGrid" type="checkbox" value="" class="form-chkbox form-chk-needed" disabled><span id="BioGridSpan">Query interactions from BioGrid</span></label>
                                    <i id="spinnerBioGrid" class="fa fa-refresh fa-spin" aria-hidden="true"></i>
                                </div>

                                <div class="checkbox">
                                    <label class="not-allowed"><input id="queryIntAct" type="checkbox" class="form-chkbox form-chk-needed" value="" disabled><span id="IntActSpan">Query interactions from IntAct</span></label>
                                    <i id="spinnerIntAct" class="fa fa-refresh fa-spin" aria-hidden="true"></i>
                                </div>

                                <div class="checkbox">
                                    <label><input id="queryBAR" type="checkbox" class="form-chkbox form-chk-needed" value="" checked>Query protein-protein interactions from BAR</label>
                                </div>

                                <div class="checkbox">
                                    <label class="" ><input id="recursive" type="checkbox" class="form-chkbox form-chk-needed" value="">Search for interactions between interactors</label>
                                </div>

                                <div class="checkbox">
                                    <label><input id="queryDna" class="form-chkbox" type="checkbox" value="" checked>Query protein-DNA interactions from BAR</label>
                                </div>

                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <div class="pull-left">
                            <input type="submit" id="submit" class="form-button" value="Submit">
                            <input type="reset" id="resetForm" class="form-button" value="Reset">
                            <button type="button" class="form-button" id="example">Example</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- Form -->

        <!-- Legend -->
        <div id="LegendModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>Legend</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    <div class="modal-body">
                        <img src="images/legendAIV.png" alt="Legend">
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div> <!-- Legend -->

        <!-- PNG Export -->
        <div id="PNGModal" class="modal fade centered-modal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>PNG Export</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    <div class="modal-body">
                        <img id="png-export" src="" alt="PNG export">
                    </div>
                </div>
            </div>
        </div>

        <!-- JSON Export -->
        <div id="JSONModal" class="modal fade centered-modal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>JSON Export</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    <div class="modal-body ">
                        <pre>
                            <code id="json-export" class="json">
                                Cytoscape app not yet loaded
                            </code>
                        </pre>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="copy-to-clipboard" class="btn btn-default" title="Not supported in some browsers">
                            Copy to Clipboard
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CSV Export -->
        <div id="CSVModal" class="modal fade centered-modal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="flex-container-header">
                            <h4>CSV Export</h4>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    <div class="modal-body ">
                        <table id="csvTable">
                            <thead>
                                <tr>
                                    <th>Interaction Type </th>
                                    <th>Database Source</th>
                                    <th>Gene 1 (Target)</th>
                                    <th>Gene 2 (Source)</th>
                                    <th>Gene 1 Annotation</th>
                                    <th>Gene 2 Annotation</th>
                                    <th>Interolog Confidence/S-PPI rank</th>
                                    <th>Pearson Correlation</th>
                                    <th>Reference</th>
                                    <th>MI Term</th>
                                    <th>Gene 1 Localization</th>
                                    <th>Gene 2 Localization</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="exportCSV" class="btn btn-default">
                            Download CSV
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </body>
    <!-- AIV 2.0 JS -->
    <script src="scripts/aiv.js"></script>
    <!-- AIV 2.0 UI Options JS -->
    <script src="scripts/aiv_ui.js"></script>
</html>

